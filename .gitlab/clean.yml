# Manual job to clean cargo cache
cargo:clean:
  # Run the job under the `prepare` stage.
  stage: clean
  # Add the `docker-exec` tag to run this job in a docker container.
  tags: [docker-exec]
  # Allows the job to be interrupted when already started.
  interruptible: true
  # Use a previously built `build-env` image as a base. It includes all
  # dependencies needed to build and test.
  extends:
    - .build-env-image
    - .cargo-target-cache
  # Override the cache of the current branch.
  script:
    - cargo clean
    - mkdir target
  # Mark job as manual.
  when: manual

docker:clean:
  # Run the job under the `prepare` stage.
  stage: clean
  # Add the `docker-exec` tag to run this job in a docker container.
  tags: [shell-exec]
  # Allows the job to be interrupted when already started.
  interruptible: true
  # dependencies needed to build and test.
  # Override the cache of the current branch.
  script:
    - docker buildx prune -f
  # Mark job as manual.
  when: manual
